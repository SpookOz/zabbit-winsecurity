<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.2</version>
    <date>2020-12-08T04:53:32Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>WinSoftware-v5</template>
            <name>WinSoftware-v5</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>ListSoftware</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>List-Software</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>Software.list[*]</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Need to configure conf file on client with line: UserParameter=Software.list[*],powershell.exe -command &quot;$list = Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* ; $list += Get-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\* ; $list | Where-Object {$_.DisplayName -and $_.UninstallString } | Select-Object DisplayName | Format-Table -AutoSize&quot;</description>
                    <inventory_link>SOFTWARE_FULL</inventory_link>
                    <applications>
                        <application>
                            <name>ListSoftware</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Update WinSoftware Template</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[powershell.exe -NoProfile -ExecutionPolicy Bypass -command Invoke-WebRequest -Uri https://git.io/JUYZP -OutFile $Env:Programfiles\'Zabbix Agent\plugins\List-Installed-Software.ps1',nowait]</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>ListSoftware</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>ListSoftware</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[powershell.exe -NoProfile -ExecutionPolicy Bypass -file &quot;%programfiles%\Zabbix Agent\plugins\List-Installed-Software.ps1&quot;,nowait]</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>Saves software list to C:\IT. NEeds $Env:Programfiles\'Zabbix Agent\plugins\List-Installed-Software.ps1 to work</description>
                    <applications>
                        <application>
                            <name>ListSoftware</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
    </templates>
</zabbix_export>
